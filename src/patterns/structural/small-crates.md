# Предпочитайте маленькие крейты

## Описание

Предпочитайте маленькие крейты, которые хорошо выполняют одну задачу.

Cargo и crates.io упрощают добавление сторонних библиотек, гораздо больше, чем в C или C++. Кроме того, поскольку пакеты на crates.io не могут быть отредактированы или удалены после публикации, любая сборка, которая работает сейчас, должна продолжать работать в будущем. Мы должны использовать этот инструментарий и использовать более мелкие, более детализированные зависимости.

## Преимущества

- Маленькие крейты легче понимать и поощряют более модульный код.
- Крейты позволяют повторно использовать код между проектами.
  Например, крейт `url` был разработан как часть браузерного движка Servo,
  но с тех пор нашел широкое применение за пределами проекта.
- Поскольку единицей компиляции Rust является крейт, разделение проекта на несколько крейтов может позволить большей части
  кода быть построенным параллельно.

## Недостатки

- Это может привести к "аду зависимостей", когда проект зависит от нескольких конфликтующих
  версий крейта одновременно. Например, крейт `url` имеет обе версии
  1.0 и 0.5. Поскольку `Url` из `url:1.0` и `Url` из `url:0.5` - это
  разные типы, HTTP-клиент, который использует `url:0.5`, не примет значения `Url`
  от веб-скрейпера, который использует `url:1.0`.
- Пакеты на crates.io не проходят курирование. Крейт может быть написан плохо, иметь
  неинформативную документацию или быть явно вредоносным.
- Два маленьких крейта могут быть менее оптимизированы, чем один большой, поскольку компилятор
  по умолчанию не выполняет оптимизацию времени связывания (LTO).

## Примеры

Крейт [`url`](https://crates.io/crates/url) предоставляет инструменты для работы с
URL-адресами.

Крейт [`num_cpus`](https://crates.io/crates/num_cpus) предоставляет функцию для
запроса количества ЦП на машине.

Крейт [`ref_slice`](https://crates.io/crates/ref_slice) предоставляет функции
для преобразования `&T` в `&[T]`. (Исторический пример)

## Смотрите также

- [crates.io: хост-сообщество Rust](https://crates.io/)